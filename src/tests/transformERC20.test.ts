import { it, expect, describe } from "vitest";
import { parseSwap } from "../index";

require("dotenv").config();

const RPC_TEST_URL = process.env.RPC_TEST_URL;

if (!RPC_TEST_URL) {
  throw new Error("Missing environment variable `RPC_TEST_URL`");
}

describe("transformERC20 with native input asset", () => {
  // https://etherscan.io/tx/0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35
  const txReceipt = {
    _type: "TransactionReceipt",
    blockHash:
      "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
    blockNumber: 16615554,
    contractAddress: null,
    cumulativeGasUsed: "818466",
    from: "0x3F3E305C4Ad49271EBDA489dd43d2c8F027d2D41",
    gasPrice: "35265056593",
    gasUsed: "483000",
    hash: "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
    index: 1,
    logs: [
      {
        _type: "log",
        address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000001208ab4a2829cba18c",
        index: 15,
        topics: [
          "0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000000000000074ab1feed9",
        index: 16,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000001208ab4a2829cba18c",
        index: 17,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0xffffffffffffffffffffffffffffffffffffffffffffffffffffff8b54e0112700000000000000000000000000000000000000000000001208ab4a2829cba18c00000000000000000000000000000000000064a64a162e8d56a70cb0ab941613000000000000000000000000000000000000000000000001588920f28bb9d824000000000000000000000000000000000000000000000000000000000003198a",
        index: 18,
        topics: [
          "0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0x22F9dCF4647084d6C31b2765F6910cd85C178C18",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000012556e6973776170563300000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800000000000000000000000000000000000000000000001208ab4a2829cba18c00000000000000000000000000000000000000000000000000000074ab1feed9",
        index: 19,
        topics: [
          "0xe59e71a14fe90157eedc866c4f8c767d3943d6b6b2e8cd64dddcc92ab4c55af8",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x000000000000000000000000000000000000000000000000000000746a575fc6",
        index: 20,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x000000000000000000000000c9f93163c99695c6526b799ebca2207fdf7d61ad",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000000000000074ab1feed9",
        index: 21,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x000000000000000000000000c9f93163c99695c6526b799ebca2207fdf7d61ad",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000000000000000004c4b43",
        index: 22,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x000000000000000000000000c9f93163c99695c6526b799ebca2207fdf7d61ad",
          "0x00000000000000000000000095c4f5b83aa70810d4f142d58e5f7242bd891cb0",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xC9f93163c99695c6526b799EbcA2207Fdf7D61aD",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000004c4b43",
        index: 23,
        topics: [
          "0xe4fed5362e2669c70e5da5a18942d1e617d8917f6adc0164d9668bd3a6d0cebe",
          "0x00000000000000000000000095c4f5b83aa70810d4f142d58e5f7242bd891cb0",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xC9f93163c99695c6526b799EbcA2207Fdf7D61aD",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001",
        index: 24,
        topics: [
          "0xa259c93818139b6bc90fb80e8feb75122b42edaae49560f81392cf4e1946726e",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xC9f93163c99695c6526b799EbcA2207Fdf7D61aD",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x000000000000000000000000000000000000000000000000000000746a575fc600000000000000000000000000000000000000000000000000000074ab1feed9",
        index: 25,
        topics: [
          "0xe93ad76094f247c0dafc1c61adc2187de1ac2738f7a3b49cb20b2263420251a3",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0x22F9dCF4647084d6C31b2765F6910cd85C178C18",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x0000000000000000000000000000000a446f646f000000000000000000000000000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec700000000000000000000000000000000000000000000000000000074ab1feed9000000000000000000000000000000000000000000000000000000746a575fc6",
        index: 26,
        topics: [
          "0xe59e71a14fe90157eedc866c4f8c767d3943d6b6b2e8cd64dddcc92ab4c55af8",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x000000000000000000000000000000000000000000000000000000746a575fc6",
        index: 27,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x0000000000000000000000003f3e305c4ad49271ebda489dd43d2c8f027d2d41",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
      {
        _type: "log",
        address: "0xDef1C0ded9bec7F1a1670819833240f027b25EfF",
        blockHash:
          "0x6f35212a8d14d67856cf0f6d20ffa9cee90d2f9a259ed7c5bee83f9c370bc2a3",
        blockNumber: 16615554,
        data: "0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec700000000000000000000000000000000000000000000001208ab4a2829cba18c000000000000000000000000000000000000000000000000000000746a575fc6",
        index: 28,
        topics: [
          "0x0f6672f78a59ba8e5e5b5d38df3ebc67f3c792e2c9259b8d97d7f00dd78ba1b3",
          "0x0000000000000000000000003f3e305c4ad49271ebda489dd43d2c8f027d2d41",
        ],
        transactionHash:
          "0x30d015e87dd5481609eec1c54433b8d4679fe641034971baf648d4528a9b0a35",
        transactionIndex: 1,
      },
    ],
    logsBloom:
      "0x00000002010000000004001000000000000040000000000000000000040000000001000000004000000008000000010002000000080020000000000000002000000000000001000808008008004000014000000000000000000010008200208000000000800000000000901000000000000000000000000000000010000800000000000000000000000000000000000000000001010000000080000000100000008000000001200000000080800001000000000000000000002000000008004401000002001000000000000000000800000200000000000000004000002000000000200000000400000010000000000400000000000200400000000010001400",
    status: 1,
    to: "0xDef1C0ded9bec7F1a1670819833240f027b25EfF",
  };

  it("parses swap for transformERC20", async () => {
    const data = await parseSwap({
      txReceipt,
      txDescription: {
        name: "transformERC20",
        value: 332666067836453233036n,
        args: [
          "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",
          "0xdAC17F958D2ee523a2206206994597C13D831ec7",
          332666067836453233036n,
          500000000000n,
        ],
      },
      rpcUrl: RPC_TEST_URL,
    });

    expect(data).toEqual({
      tokenIn: {
        symbol: "ETH",
        amount: "332.66606783645324",
      },
      tokenOut: {
        symbol: "USDT",
        amount: "500000.317382",
      },
    });
  });
});

describe("transformERC20 with erc20 input asset", () => {
  const txReceipt = {
    _type: "TransactionReceipt",
    blockHash:
      "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
    blockNumber: 16880821,
    contractAddress: null,
    cumulativeGasUsed: "2204789",
    from: "0x707D8Fce670759B51122Fd988AF014bb059df028",
    gasPrice: "15127177110",
    gasUsed: "342468",
    hash: "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
    index: 20,
    logs: [
      {
        _type: "log",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x0000000000000000000000000000000000000000000000000000000010642ac0",
        index: 43,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x000000000000000000000000707d8fce670759b51122fd988af014bb059df028",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x000000000000000000000000000000000000000000000000021f09e85a9c7520",
        index: 44,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000011b815efb8f581194ae79006d24e0d814b7697f6",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x0000000000000000000000000000000000000000000000000000000010642ac0",
        index: 45,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x00000000000000000000000011b815efb8f581194ae79006d24e0d814b7697f6",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0x11b815efB8f581194ae79006d24E0d814B7697F6",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0xfffffffffffffffffffffffffffffffffffffffffffffffffde0f617a5638ae00000000000000000000000000000000000000000000000000000000010642ac000000000000000000000000000000000000000000002c77270a4930cb055e7ba0000000000000000000000000000000000000000000000005a36ff62da119ba2fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffced61",
        index: 46,
        topics: [
          "0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xA49d7499271aE71cd8aB9Ac515e6694C755d400c",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x000000000000000000000000000000000000000000000009f92610ead258ba45",
        index: 47,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000090f13faa11725f4615d43035b9119acfd5c245ee",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x000000000000000000000000000000000000000000000000021f09e85a9c7520",
        index: 48,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
          "0x00000000000000000000000090f13faa11725f4615d43035b9119acfd5c245ee",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0x90F13FAa11725f4615D43035b9119aCFd5c245eE",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0xfffffffffffffffffffffffffffffffffffffffffffffff606d9ef152da745bb000000000000000000000000000000000000000000000000021f09e85a9c75200000000000000000000000000000000000000000075a122a22ec9c6902ad5f1600000000000000000000000000000000000000000000006ae1e914ce780a533dfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeea9f",
        index: 49,
        topics: [
          "0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67",
          "0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0x22F9dCF4647084d6C31b2765F6910cd85C178C18",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x00000000000000000000000000000012556e6973776170563300000000000000000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000a49d7499271ae71cd8ab9ac515e6694c755d400c0000000000000000000000000000000000000000000000000000000010642ac0000000000000000000000000000000000000000000000009f92610ead258ba45",
        index: 50,
        topics: [
          "0xe59e71a14fe90157eedc866c4f8c767d3943d6b6b2e8cd64dddcc92ab4c55af8",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xA49d7499271aE71cd8aB9Ac515e6694C755d400c",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x0000000000000000000000000000000000000000000000000c9340e6feacd9ac",
        index: 51,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x0000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xA49d7499271aE71cd8aB9Ac515e6694C755d400c",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x000000000000000000000000000000000000000000000009ec92d003d3abe099",
        index: 52,
        topics: [
          "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
          "0x00000000000000000000000022f9dcf4647084d6c31b2765f6910cd85c178c18",
          "0x000000000000000000000000707d8fce670759b51122fd988af014bb059df028",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
      {
        _type: "log",
        address: "0xDef1C0ded9bec7F1a1670819833240f027b25EfF",
        blockHash:
          "0x1b772c3c35d168bf58cc7c212b8acbd526b546757362efdf606ab8230868c137",
        blockNumber: 16880821,
        data: "0x000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000a49d7499271ae71cd8ab9ac515e6694c755d400c0000000000000000000000000000000000000000000000000000000010642ac0000000000000000000000000000000000000000000000009ec92d003d3abe099",
        index: 53,
        topics: [
          "0x0f6672f78a59ba8e5e5b5d38df3ebc67f3c792e2c9259b8d97d7f00dd78ba1b3",
          "0x000000000000000000000000707d8fce670759b51122fd988af014bb059df028",
        ],
        transactionHash:
          "0x4db5b7168686cdfb1469b47a67f03fb6199aa81f3d2a26c4a05835b8752d152d",
        transactionIndex: 20,
      },
    ],
    logsBloom:
      "0x00000002000000015000001000000000000000000000000000000000000000000001040000000000000000000000010002000000080020000000000000000000000000000040000800000008004000000000000000002000000010000000020000000000000000040001101000000000020000000000000010000090000808000000000000000000000000000080000000000000000000000400000000100000008000000000000000000080800001000000000000000000000004000000004001000002001100000000000000000400000000000000000000004000000000000000200000000400000000000000000400000000000000000008001010001400",
    status: 1,
    to: "0xDef1C0ded9bec7F1a1670819833240f027b25EfF",
  };

  it("parses swap for transformERC20", async () => {
    const data = await parseSwap({
      txReceipt,
      txDescription: {
        name: "transformERC20",
        value: 332666067836453233036n,
        args: [
          "0xdAC17F958D2ee523a2206206994597C13D831ec7",
          "0xA49d7499271aE71cd8aB9Ac515e6694C755d400c",
          275000000n,
          181227862178199637786n,
        ],
      },
      rpcUrl: RPC_TEST_URL,
    });

    expect(data).toEqual({
      tokenIn: {
        symbol: "USDT",
        amount: "275",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7"
      },
      tokenOut: {
        symbol: "MUTE",
        amount: "183.067612917791449241",
        address: '0xA49d7499271aE71cd8aB9Ac515e6694C755d400c',
      },
    });
  });
});
